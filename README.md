xresloader
==========

快速实现一个简单暴力功能强大的导表工具


工具命令行参数
======
执行方式    java -jar xresloader.jar [参数...]

|          参数选项           |         描述        |                   说明                     |
|-----------------------------|---------------------|--------------------------------------------|
|-t --output-type             | 输出类型            | bin（默认值）,lua,msgpack,json(暂未实现),xml(暂未实现)                 |
|-p --proto                   | 协议描述类型        | protobuf(默认值),capnproto(暂未实现),flatbuffer(暂未实现)      |
|-f --proto-file              | 协议描述文件        |                                            |
|-o --output-dir              | 输出目录            | 默认为当前目录                             |
|-d --data-src-dir            | 数据源根目录        | 默认为当前目录                             |
|-s --src-file                | 数据源描述文件      |                                            |
|-m --src-meta                | 数据源描述表        | 可多个                                     |
|-v --version                 | 打印版本号          |                                            |
|-n --rename                  | 重命名输出文件名    | 正则表达式 （如：/(?i)\\.bin$/\\.lua/）    |
|--enable-excel-formular      | 开启Excel公式支持   | 默认开启，使用公式会大幅减慢转表速度       |
|--disable-excel-formular     | 关闭Excel公式支持   | 关闭公式会大幅加快转表速度                 |
                
                
协议类型
------
1. **protobuf** （已实现）
2. **capnproto**    （暂未支持）
3. **flatbuffer**   （暂未支持）
                
                
数据源描述文件说明(根据后缀判断类型有不同读取方式)
------
|     数据源描述文件后缀      |                                  数据源描述表                                  |           说明           |
|-----------------------------|--------------------------------------------------------------------------------|--------------------------|
|         .xls,.xlsx          | 视作Excel文件，数据源描述表为Excel内的Sheet名称                                |已实现, 非微软格式尚未测试|
|     .ini,.conf,.cfg         | 视作ini文件，数据源描述表为ini内的Section名称                                  |(暂未支持)                |
|          .json              | 视作json文件，数据源描述表为json内的第一层子节点名称                           |(暂未支持)                |
|          .xml               | 视作json文件，数据源描述表为xml内的根节点下的子节点TagName，并且只取第一个     |(暂未支持)                |


数据源描述表配置项及示例
======
|     字段     |                        简介                      |           主配置           |     次配置   |   补充配置   |     说明     |
|--------------|--------------------------------------------------|----------------------------|--------------|--------------|--------------|
|DataSource    | 配置数据源(文件路径,表名)                        |    ./资源转换示例.xlsx     | kind         |  3,1         |   **必须**   |
|MacroSource   | 元数据数据源(文件路径,表名)                      |  ./资源转换示例.xlsx       | macro        |  2,1         |    *可选*    |
|编程接口配置  |
|ProtoName     | 协议描述名称                                     |   role_cfg                 |              |              |   **必须**   |
|OutputFile    | 输出文件                                         |   role_cfg.bin             |              |              |   **必须**   |
|KeyRow        | 字段名描述行                                     |  2                         |              |              |   **必须**   |
|KeyCase       | 字段名大小写                                     | 小写                       |              |              |大写/小写/不变|
|KeyWordSplit  | 字段名分词字符                                   | _                          |              |              |    *可选*    |
|KeyPrefix     | 字段名固定前缀                                   |                            |              |              |    *可选*    |
|KeySuffix     | 字段名固定后缀                                   |                            |              |              |    *可选*    |
|KeyWordRegex  | 分词规则(判断规则,移除分词符号规则,前缀过滤规则) | [A-Z_\$ \t\r\n]            | [_\$ \t\r\n] | [a-zA-Z_\$]  | 正则表达式*(可选)*|
|Encoding      | 编码转换                                         | UTF-8                      |              |              |注：Google的protobuf库的代码里写死了UTF-8(2.6.1版本)，故而该选项对Protobuf无效|


使用注意事项
======
1. Excel里编辑过的单元格即便删除了也会留下不可见的样式配置，这时候会导致转出的数据有空行。可以通过在Excel里删除行解决